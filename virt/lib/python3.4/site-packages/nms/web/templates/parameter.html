{% extends "base.html" %}

{% block title %} {{device.full_name}}:{{parameter.full_name}}{% endblock %}

{% block scripts %}
<script language="javascript" type="text/javascript" src="/static/js/highcharts/highstock.js"></script>
<script language="javascript" type="text/javascript" src="/static/js/highcharts/exporting.js"></script>
<script language="javascript" type="text/javascript" src="/static/js/plot.js"></script>
<script language="javascript" type="text/javascript">
    // Create the chart
    $(function () {
        var plot_parameters = {
            device_name: "{{device.name}}",
            param_name: "{{parameter.name}}",
            param_fullname: "{{parameter.full_name}}",
            param_units: "{{parameter.units}}",
            height: null,
            ymax: {% if parameter.get_max_y() is none %}
                    null
                  {% else %}
                    {{parameter.get_max_y()}}
                  {% endif %},
            ymin: {% if parameter.get_min_y() is none %}
                    null
                  {% else %}
                    {{parameter.get_min_y()}}
                  {% endif %},
            navigator_enabled: true,
            boundaries: {
                errors: [
                {% if parameter.boundaries.err_max is not none %}
                    {{ parameter.boundaries.err_max| tojson | safe}},
                {%endif%}
                {% if parameter.boundaries.err_min is not none %}
                    {{ parameter.boundaries.err_min| tojson | safe}},
                {%endif%}
                ],
                warnings: [
                {% if parameter.boundaries.warn_min is not none %}
                    {{ parameter.boundaries.warn_min| tojson | safe}},
                {%endif%}
                {% if parameter.boundaries.warn_max is not none %}
                    {{ parameter.boundaries.warn_max| tojson | safe}},
                {%endif%}
                ],
            }
        };
        plot_single_parameter('#container', plot_parameters); 
    });
</script>

{% endblock %}

{% block left %}
    <div class="device_menu">
        <div class="info-block">
        <a class='device-back-link' href='/nms/device/{{ device.name }}'>{{ device.full_name }}</a>
        <div class="info_text">
            <b>{{ parameter.desc }} </b> <br>
            {% if parameter.protocol != 'calc' %}
                Протокол: {{parameter.protocol}} <br>
            {% endif %}
            {% if parameter.boundaries.err_max %}
            Верхний критический предел: {{parameter.boundaries.err_max}}
            ({{parameter.units}})<br>
            {% endif %}
            {% if parameter.boundaries.warn_max %}
            Верхний предел: {{parameter.boundaries.warn_max}}
            ({{parameter.units}})<br>
            {% endif %}
            {% if parameter.boundaries.warn_min %}
            Нижний предел: {{parameter.boundaries.warn_min}}  ({{parameter.units}})<br>
            {% endif %}
            {% if parameter.boundaries.err_min %}
            Нижний критический предел: {{parameter.boundaries.err_min}}
            ({{parameter.units}})<br>
            {% endif %}
        </div>
        </div>
    </div>
{% endblock %}

{% block right %}
    <div class="right">
        <div class="box-decorate">
        Обновлять график автоматически <input type="checkbox" id="do_update_plots" checked />
        </div>
        <div class="box-decorate">
            <div id="container" class='big-chart'></div>
        </div>
    </div> <!--right end-->

{% endblock %}
