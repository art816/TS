{% extends "base.html" %}
 {% block title %} Управление питанием {% endblock %}
{% block left %}
    <div class="demo-container device_power_control">
            <form action="/nms/power_control/" style="display: inline" method='POST'>
            {% for device in gpu_bmc_servers %}
                <div class="menu_entry">
                    <div style="margin-left: 10px;float: left;">
                    {{ device.full_name }}
                    </div>
                    <div style="float: right;">
                    <input type="radio" name="order_for_{{device.name}}" value="None" checked>Бездействие
                    <input type="radio" name="order_for_{{device.name}}" value="ON">Включить
                    <input type="radio" name="order_for_{{device.name}}" value="OFF">Выключить
                    <input type="radio" name="order_for_{{device.name}}" value="Reboot">Перезагрузить
                    </div>
                </div>
            {% endfor %}
            {% for device in other_bmc_dev %}
                <div class="menu_entry">
                    <div style="margin-left: 10px;float: left;">{{ device.full_name }}</div>
                    <div style="float: right;">
                    <input type="radio" name="order_for_{{device.name}}" value="None" checked>Бездействие
                    <input type="radio" name="order_for_{{device.name}}" value="ON">Включить
                    <input type="radio" name="order_for_{{device.name}}" value="OFF">Выключить
                    <input type="radio" name="order_for_{{device.name}}" value="Reboot">Перезагрузить
                    </div>
                </div>
            {% endfor %}
            <center>
                <input type="submit" value="Подтвердить комманды">
            </center>
            </form>
    </div>
    <div class="demo-container pdu_power_control">
            Распределители питания: Вкл./Выкл. розеток
            {% for pdu in pdus %}
            <div class="pdu_group">{{ pdu.full_name }}
                {% if pdu.is_online %}
                Доступен
                {% else %}
                Не доступен
                {% endif %}
            
            </div>
                <div style="display:none">
                    <table class="small-text">
                    <tr>
                        <td>Все выходы</td>
                        <td><a href="/nms/power_control/{{pdu.name}}/on/0">Вкл.</a></td>
                        <td><a href="/nms/power_control/{{pdu.name}}/off/0">Выкл.</a></td>
                    </tr>
                    </table>
                    <table class="small-text">
                    {% for key, outlet_table in outlet_states.items %}
                        {% if key == pdu.name %}
                            {% for outlet_number, outlet_state in outlet_table.items %}
                            <tr>
                            <td>Выход №{{ forloop.counter }}</td>
                            <td><a href="/nms/power_control/{{pdu.name}}/on/{{outlet_number}}">Вкл.</a></td>
                            <td><a href="/nms/power_control/{{pdu.name}}/off/{{outlet_number}}">Выкл.</a></td>
                            <td>Статус: {{ outlet_state }}</td>
                            </tr>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                    </table>
                </div>
            {% endfor %}
    <script>
    $(".pdu_group").click(function() {
        $(this).next().toggle( "blind" );;
    });
    </script>
            </div>
        </div>
    </div>
    <div class="demo-container">
        <center>
        <form action="/nms/power_control/" method="post" style='margin: 20 auto; padding: 10px; display: inline;'>
            <input type="submit" name='all_' value="Выключить ПАК"/>
            <input type="submit" name='all_' value="Запустить ПАК"/>
            <input type="submit" name="all_" value="Выключить ПАК и мониторинг" id="red_button" />
        </form>
        </center>
    </div>
{% endblock %}
